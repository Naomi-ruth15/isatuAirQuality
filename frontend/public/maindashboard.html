<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Modern Air Quality Dashboard</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script> 

  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/justgage/1.4.0/justgage.min.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script> 


  

  <!-- Google Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <style>
    * {
      font-family: 'Inter', sans-serif;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; }
    ::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.3); border-radius: 10px; }

    /* Glass Card */
    .glass-card {
      backdrop-filter: blur(15px);
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    /* Sidebar Gradient */
    .sidebar-glass {
      backdrop-filter: blur(15px);
      background: linear-gradient(135deg, #1e3a8a, #3b82f6); 
    }

    /* Level Colors */
    .level-good { background-color: #D1F1D1; }
    .level-moderate { background-color: #FFE082; }
    .level-unhealthy { background-color: #FFA726; }
    .level-hazardous { background-color: #EF5350; }

    /* Hover Scale Animation */
    .hover-scale:hover {
      transform: scale(1.02);
      transition: transform 0.2s ease-in-out;
    }

    /* Modal Styles */
    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }

    .modal-card {
      background: white;
      padding: 1rem;
      border-radius: 1rem;
      max-width: 800px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .station-card {
      border: 1px solid #ddd;
      padding: 1rem;
      margin: 0.5rem;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: 0.2s;
    }

    .station-card:hover {
      background-color: #f0f8ff;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen">

<!-- SIDEBAR -->
<aside id="sidebar" class="fixed top-0 left-0 h-full w-64 sidebar-glass text-white z-40 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col">
  <div class="p-4 border-b border-white/20">
    <h1 class="text-xl font-bold">AirWatch</h1>
    <p class="text-sm text-white/70">Quality Monitor</p>
  </div>
  <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
    <a href="maindashboard.html" class="block px-3 py-2 rounded hover:bg-blue-800 text-white nav-link">
      <img src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/icons/grid.svg" class="nav-icon inline mr-2" alt="Dashboard" />
      Dashboard
    </a>
    <a href="home.html" class="block px-3 py-2 rounded hover:bg-blue-800 text-white nav-link">
      <img src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/icons/home.svg" class="nav-icon inline mr-2" alt="Home" />
      Home
    </a>
   <div class="space-y-1">
  <button id="parametersToggle" class="w-full text-left px-3 py-2 rounded hover:bg-blue-800 flex justify-between items-center nav-link">
    <span class="flex items-center">
      <img src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/icons/sliders.svg" class="w-5 h-5 mr-2" alt="Parameters" />
      Parameters
    </span>
    <i id="dropdownArrow" class="fas fa-chevron-down"></i>
  </button>
  <div id="parametersDropdown" class="hidden ml-6 space-y-1">
    <a href="parameters/tvoc.html" class="block px-3 py-1 text-sm hover:bg-blue-800 rounded dropdown-item flex items-center">
<img src="https://cdn.jsdelivr.net/npm/lucide-static@0.292.0/icons/test-tube.svg" class="w-5 h-5 mr-2" alt="TVOC" />
      TVOC
    </a>
    <a href="parameters/eco2.html" class="block px-3 py-1 text-sm hover:bg-blue-800 rounded dropdown-item flex items-center">
      <img src="https://cdn.jsdelivr.net/npm/@tabler/icons@2.18.0/icons/cloud.svg" class="w-5 h-5 mr-2" alt="eCO2" />
      eCO2
    </a>
    <a href="parameters/temperature.html" class="block px-3 py-1 text-sm hover:bg-blue-800 rounded dropdown-item flex items-center">
      <img src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/icons/thermometer.svg" class="w-5 h-5 mr-2" alt="Temperature" />
      Temperature
    </a>
    <a href="parameters/humidity.html" class="block px-3 py-1 text-sm hover:bg-blue-800 rounded dropdown-item flex items-center">
      <img src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/icons/droplet.svg" class="w-5 h-5 mr-2" alt="Humidity" />
      Humidity
    </a>
    <a href="parameters/dustDensity.html" class="block px-3 py-1 text-sm hover:bg-blue-800 rounded dropdown-item flex items-center">
      <img src="https://cdn.jsdelivr.net/npm/@mdi/svg/svg/air-filter.svg" class="w-5 h-5 mr-2" alt="Dust Density" />
      Dust Density
    </a>
  </div>
</div>
    <a href="history.html" class="block px-3 py-2 rounded hover:bg-blue-800 text-white nav-link">
      <img src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/icons/clock.svg" class="nav-icon inline mr-2" alt="History" />
      History
    </a>
    <a href="historicalAQI.html" class="block px-3 py-2 rounded hover:bg-blue-800 text-white nav-link">
      <img src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/icons/wind.svg" class="nav-icon inline mr-2" alt="Air Quality" />
      Air Quality Index
    </a>
  </nav>
</aside>


<!-- HAMBURGER BUTTON -->
<button id="hamburger" class="lg:hidden fixed top-4 left-4 z-50 p-2 bg-blue-600 text-white rounded shadow-md">
  <i class="fas fa-bars"></i>
</button>

<!-- MAIN CONTENT -->
<main class="lg:ml-64 p-6 min-h-screen transition-all duration-300">
  <header class="mb-6">
    <h1 class="text-3xl font-bold text-gray-800">Air Quality Dashboard</h1>
    <p class="text-gray-600">Real-time monitoring of environmental parameters</p>
  </header>

  <!-- STATION SELECTOR -->
  <section class="mb-6 glass-card p-4 rounded-lg shadow">
    <button id="openStationModal" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition mb-2">
      <i class="fas fa-broadcast-tower mr-2"></i>Select Monitoring Station
    </button>
    <p id="lastUpdated" class="mt-2 text-sm text-gray-500">Last updated: --</p>
  </section>

  <!-- SELECTED STATION CARD -->
  <div id="selectedStationCard" class="mb-6 hidden glass-card p-4 rounded-lg shadow-md flex items-center space-x-4">
    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
      <i class="fas fa-broadcast-tower text-blue-600 text-xl"></i>
    </div>
    <div>
      <p class="text-sm text-gray-600">Selected Station</p>
      <p id="selectedStationText" class="text-lg font-medium">None selected</p>
    </div>
  </div>

  <!-- AQI CHART -->
<section class="mb-6 glass-card p-6 rounded-lg shadow">
  <canvas id="aqiChart" height="100"></canvas>
</section>

  <!-- GAUGES SECTION -->
  <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6">
    <div class="glass-card p-4 rounded-lg text-center hover-scale">
      <div id="tvocGauge" style="height: 160px;"></div>
      <h3 class="font-semibold mt-2">TVOC</h3>
      <p id="tvocStatus" class="mt-1 text-sm"></p>
    </div>
    <div class="glass-card p-4 rounded-lg text-center hover-scale">
      <div id="eCO2Gauge" style="height: 160px;"></div>
      <h3 class="font-semibold mt-2">eCO2</h3>
      <p id="eCO2Status" class="mt-1 text-sm"></p>
    </div>
    <div class="glass-card p-4 rounded-lg text-center hover-scale">
      <div id="temperatureGauge" style="height: 160px;"></div>
      <h3 class="font-semibold mt-2">Temperature</h3>
      <p id="temperatureStatus" class="mt-1 text-sm"></p>
    </div>
    <div class="glass-card p-4 rounded-lg text-center hover-scale">
      <div id="humidityGauge" style="height: 160px;"></div>
      <h3 class="font-semibold mt-2">Humidity</h3>
      <p id="humidityStatus" class="mt-1 text-sm"></p>
    </div>
    <div class="glass-card p-4 rounded-lg text-center hover-scale">
      <div id="dustGauge" style="height: 160px;"></div>
      <h3 class="font-semibold mt-2">Dust Density</h3>
      <p id="dustDensityStatus" class="mt-1 text-sm"></p>
    </div>
  </section>

  <!-- COMPOSITE AQI SCORE -->
  <section class="mb-6 glass-card p-6 rounded-lg shadow flex flex-col items-center">
    <h2 class="text-xl font-semibold mb-4">Overall Air Quality Index</h2>
    <div id="weightedContainer" class="my-4">
      <div id="totalGauge" style="height: 200px; width: 200px;"></div>
    </div>
    <div id="aqiStatus" class="mt-4 px-4 py-2 rounded-full text-sm font-medium">
      Calculating...
    </div>
  </section>

  <!-- AQI CHART -->
  <section class="mb-6 glass-card p-6 rounded-lg shadow">
    <canvas id="aqiChart" height="100"></canvas>
  </section>

  <!-- DYNAMIC DATA CARDS -->
  <section id="dataContainer" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></section>
</main>

<!-- MODAL FOR STATION SELECTION -->
<div id="stationModal" class="modal hidden">
  <div class="modal-card">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-bold">Select Monitoring Station</h2>
      <button id="closeStationModal" class="text-red-500"><i class="fas fa-times text-xl"></i></button>
    </div>
    <div id="stationCardsContainer" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
  </div>
</div>

<!-- Load dashboard.js -->
<script src="./scripts//dashboard.js"></script>

<!-- Inline Scripts for UI Interactivity -->
<script>
  // Page-specific JS

  window.onload = () => {
    initGauges();
    loadStations();
    fetchLatestData();
  };

  // Toggle Parameters Dropdown
  document.getElementById('parametersToggle').addEventListener('click', () => {
    const dropdown = document.getElementById('parametersDropdown');
    const arrow = document.getElementById('dropdownArrow');
    dropdown.classList.toggle('hidden');
    arrow.classList.toggle('rotate-180');
  });

  // Modal Controls
  document.getElementById('openStationModal').addEventListener('click', () => {
    document.getElementById('stationModal').classList.remove('hidden');
  });

  document.getElementById('closeStationModal').addEventListener('click', () => {
    document.getElementById('stationModal').classList.add('hidden');
  });
</script>

<!-- Sidebar Toggle Logic -->
<script>
  const sidebar = document.getElementById('sidebar');
  const hamburger = document.getElementById('hamburger');

  hamburger.addEventListener('click', () => {
    sidebar.classList.remove('-translate-x-full');
  });

  document.addEventListener('click', (e) => {
    if (
      window.innerWidth < 768 &&
      !sidebar.contains(e.target) &&
      !hamburger.contains(e.target)
    ) {
      sidebar.classList.add('-translate-x-full');
    }
  });
</script>

</body>
</html>